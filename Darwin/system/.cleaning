# OSX cleaning aliases / functions

## Remove all logs
alias clear_logs='sudo find /private/var/log/ -ls -delete 2>/dev/null'

## Recursively remove .DS_Store files
alias cleanupds="sudo find / -type f -name '*.DS_Store' -ls -delete 2>/dev/null"

## Remove all temp files
alias clear_temps='sudo find /tmp "$(/usr/bin/getconf DARWIN_USER_CACHE_DIR)" "$(echo $TMPDIR)" -ls -delete 2>/dev/null'

## Full gem cleanup
alias gem_cache_clean="rm -rf /usr/local/Cellar/ruby/2.3.0/lib/ruby/gems/2.3.0/cache/ 2>/dev/null; gem cleanup; gem sources -c"

## Clear all browsers data
alias clear_all_browsers='for script in $(ls ~/src/osx-clear-browser-histories | grep "sh" | cut -d "." -f 1); do $script; done'

## Empty the trash on all mounted volumes and the main HDD.
## Also, clear Appleâ€™s System Logs to improve shell startup speed.
## Finally, clear download history from quarantine. https://mths.be/bum
function emptytrash() {
    sudo find /Volumes/*/.Trashes ~/.Trash -ls -delete 2>/dev/null;
    sudo find /private/var/log/asl/ -name "*.asl" -ls -delete 2>/dev/null;
    sqlite3 ~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV* "delete from LSQuarantineEvent";

    echo ''
    echo 'emptytrash: Done.'
    echo '' 
}

## Recursively remove all installers, exclude downloads and external drives
function remove_all_installers() {
    sudo find / -not -path '$HOME/Downloads/*' -not -path '/Volumes/*' -type f \( -name '*.dmg' -o -name '*.pkg' \) -ls -delete 2>/dev/null;

    echo ''
    echo 'remove_all_installers: Done.'
    echo '' 
}

## Full brew cleanup (junk)
function brew_full_clean() {
    brew cleanup --force;
    brew cask cleanup --force;
    brew prune;
    find /opt/homebrew-cask/Caskroom -type f \( -name '*.dmg' -o -name '*.pkg' \) -ls -delete 2>/dev/null;
    find /Library/Caches/Homebrew/ -type f -ls -delete 2>/dev/null;
    
    echo ''
    echo 'brew_full_clean: Done.'
    echo ''  
}

function clear_home() {
    rm -f ~/.*sh_history
    rm -f ~/.vim_mru_files
    rm -f ~/.viminfo
    rm -f ~/.wget-hsts
    rm -f ~/.zcompdump*
    rm -f ~/.rnd
    rm -f ~/.pythonhist
    rm -f ~/.python_history
    rm -f ~/.psql_history
    rm -f ~/.msf4/history
    rm -f ~/.lesshst
    rm -rf ~/.tor
    rm -rf ~/.vim_runtime/temp_dirs/*
    rm -rf ~/.lldb
    rm -rf ~/.john
    rm -rf ~/.recon-ng
    rm -rf ~/.msf4/logs/*
    rm -rf ~/.oracle_jre_usage
    rm -rf ~/.msf4/loot/*
    rm -rf ~/.matplotlib
    rm -rf ~/.local/share
    rm -rf ~/.cache
}

## Prepare to backup (remove all junk)
function prepare_to_backup() {
    revert_all_parallels_machines;
    sublime_clean;
    cleanupds;
    clear_all_browsers
    clear_home;
    remove_all_installers;
    gem_cache_clean;
    brew_full_clean;
    clear_temps;
    clear_logs;
    emptytrash;

    echo ''
    echo 'prepare_to_backup: Done.'
    echo ''
}
